# linux
Учебные конфиги для линукса, которые выполняют нижепоставленные задачи
    
    
Вы пытаетесь обезопасить свой собственный сервер. На нем среди прочего находится ваш скрипт, который блокирует нежелательные запросы.
Дано: nmap, tcpdump, iptables.
Требуется написать скрипт, который будет отслеживать подозрительную сетевую активность. Скрипт запускается по крону РАЗ в ОДИН ЧАС. В начале он собирает 1000 пакетов, которые в дальнейшем начинает проверять.
Требуется искать:
• все попытки сканирования сетевых портов при помощи nmap (1),
• все tcp-пакеты, в которых идет инициализация TCP соединения (2).

Если найдены такие ip адреса для (1) и\или (2), то они блокируются при помощи iptables сроком на X часов. В случае (2) будем считать, что таких пакетов должно быть не меньше 100 за 2 минуты от одного ip адреса.     Через X часов они должны быть разблокированы. Если через Y часов (Y>X) эти ip адреса вновь будут уличены в подобном, то срок блокировки возрастает в двое.
